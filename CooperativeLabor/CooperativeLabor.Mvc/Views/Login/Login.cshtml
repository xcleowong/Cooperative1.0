<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>合作化用工后台登录</title>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link href="~/Content/Layui_X_Admin/css/font.css" rel="stylesheet" />
    <link href="~/Content/Layui_X_Admin/css/xadmin.css" rel="stylesheet" />
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="~/Content/Layui_X_Admin/lib/layui/layui.js"></script>
    <script src="~/Content/Layui_X_Admin/js/xadmin.js"></script>
    <script src="~/Scripts/Md5/md5.js"></script>

    <style>
      
        /*顶部下拉信息提示框*/
        .messageBox {
            height: 52px;
            padding: 0 53px 0 78px;
            line-height: 52px;
            /*background: url(/Images/img-set1.png) -441px -613px #ffffe7 no-repeat;*/
            background: url(../../Images/img-set1.png) -441px -613px #ffffe7 no-repeat;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            position: fixed;
            top: -60px;
            left: 50%;
            border: 5px solid #ddd;
            border-top: 0;
            color: #444;
            font-size: 18px;
            z-index: 9999;
        }

        .messageError {
            background-position: -441px -673px;
        }
    </style>
</head>
<body class="login-bg">

    <div class="login layui-anim layui-anim-up">
        <div class="message">合作化用工管理登录</div>
        <div id="darkbannerwrap"></div>

        <form id="form1" method="post" class="layui-form">
            <input name="UserName" placeholder="用户名" type="text" lay-verify="required" class="layui-input">
            <hr class="hr15">
            <input name="UserPassword" lay-verify="required" placeholder="密码" type="password" class="layui-input">
            <hr class="hr15">
            @*<input value="登录" lay-submit lay-filter="login" style="width:100%;"  type="submit">*@
            <input value="登录" style="width:100%;" onclick="Login()" type="button">

            <hr class="hr20">
        </form>
    </div>
    <!-- 通用提示框 -->
    <div class="messageBox"></div>
    <script>

        function Login() {
            var pwd = $("input[name=UserPassword]").val();
            $.ajax({
                url: "/PartnerMVC/GetMd5Str",
                data: {
                    UserPassword: pwd,
                },
                type: "post",
                success: function (data) {
                    $.ajax({
                        url: "http://localhost:8099/Login/Login",
                        type: "get",
                        data: {
                            UserName: $("input[name=UserName]").val(),
                            UserPassword: data,
                        },
                        success: function (data) {
                            if (data != null) {
                                //页头下拉提示框
                                $(".messageBox").removeClass("messageError").text("登录成功！！").css("margin-left", -($(".messageBox").outerWidth() / 2)).animate({ top: 0 }, "fast").delay(1500).animate({ top: "-57px" }, "fast");
                                localStorage.user = JSON.stringify(data);
                               location.href = '/Login/LoginIndex'
                               // location.href = '/Login/Index'
                            }
                            else {
                                //页头下拉提示框
                                $(".messageBox").addClass("messageError").text("用户名或密码错误").css("margin-left", -($(".messageBox").outerWidth() / 2)).animate({ top: 0 }, "fast").delay(1500).animate({ top: "-57px" }, "fast");
                            }
                        }
                    })
                }
            })
        }
        $(function () {

        })
    </script>

</body>
</html>