@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>考勤管理</title>
    <script src="~/Scripts/vue.js"></script>
    <script src="~/Scripts/vue.min.js"></script>
    <script src="~/Scripts/vue-resource.js"></script>
    <script src="~/Scripts/axios.js"></script>
    <script src="~/Scripts/axios.min.js"></script>
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-3.3.1.js"></script>
</head>
<body>
    <div>
        <div id="app">
            @*<p>当前时间：{{nowTime}}</p>*@
            &nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="btn" value="签到" v-on:click="signIn()" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="button" class="btn" value="签退" v-on:click="signBack()" />
            <table v-show="GetCheckingIns.length" class="table-condensed" border="1" style="width:100%">
                <tr>
                    <td>序号</td>
                    <td>签到时间</td>
                    <td>签退时间</td>
                    <td>签到状态</td>
                </tr>
                <tr v-for="(item,index) in GetCheckingIns">
                    <td>{{index+1}}</td>
                    <td>{{item.SignInTime}}</td>
                    <td>{{item.SignBackTime}}</td>
                    <td id="statetd">
                        @*{{item.SignInState}}*@
                        {{item.StrState}}
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html>

<script type="text/javascript">
    var StaffId = 1;
    var vm = new Vue({
        el: "#app",
        data: {
            //all: 8, //总页数
            //cur: 1,//当前页码
            GetCheckingIns: []
        },
        //watch: {
        //    cur: function (oldValue, newValue) {
        //        console.log(arguments);
        //    }
        //},
        // 创建完成时
        //created() {
        //    this.nowTimes();
        //},
        // 挂载完成时
        mounted() {
            this.getCheckingIn(StaffId);
            //this.nowTimes();
        },
        methods: {
            //页码点击事件
            //btnClick: function (data) {
            //    if (data != this.cur) {
            //        this.cur = data
            //        this.getCheckingIn(data);
            //    }
            //},
            //pageClick: function () {
            //    console.log('现在在' + this.cur + '页');
            //    this.getCheckingIn(StaffId,this.cur);
            //},
            //显示签到记录
            //getCheckingIn: function (StaffId, id) {
            //    axios.get("http://localhost:8099/checkingIn/getCheckingIn?StaffId=" + StaffId + "&currentpage=" + id).then(
            //        (response) => {
            //            this.UserList = [];
            //            this.cur = response.data.CurrentPage;
            //            this.all = response.data.TotlePage;
            //            for (var i = 0; i < response.data.PageData.length; i++) {
            //                this.UserList.push(response.data.PageData[i]);
            //            }
            //            this.GetCheckingIns = UserList;
            //        },
            //        (response) => {
            //            alert(response.status);
            //        }
            //    ).catch(function (response) {
            //        alert(response);
            //    });
            //},
            getCheckingIn: function (StaffId) {
                axios.get("http://localhost:8099/checkingIn/getCheckingIn?StaffId=" + StaffId ).then(
                    (response) => {
                        console.log(response);
                        this.GetCheckingIns = response.data;
                    },
                    (response) => {
                        alert(response.status);
                    }
                ).catch(function (response) {
                    alert(response);
                });
            },
            //签到/签退
            signIn: function () {
                var aoru = 1;
                var staffId = 1;
                var staffName = '张三';
                axios.post('http://localhost:8099/checkingIn/checkingIn?StaffId=' + staffId + "&StaffName=" + staffName + "&aoru=" + aoru).then(
                    (response) => {
                        console.log(response.data);
                        if (response.data > 0) {
                            alert("签到成功!");
                            this.getCheckingIn(staffId);
                        }
                        //console.info(this.list);
                    },
                    (response) => {
                        alert(response.status);
                    }
                ).catch(function (response) {
                    alert(response);
                });
            },
            //签退
            signBack: function () {
                var aoru = 2;
                var staffId = 1;
                var staffName = '张三';
                axios.post('http://localhost:8099/checkingIn/checkingIn?StaffId=' + staffId + "&StaffName=" + staffName + "&aoru=" + aoru).then(
                    (response) => {
                        console.log(response.data);
                        if (response.data > 0) {
                            alert("签退成功!");
                            this.getCheckingIn(staffId);
                        }
                        //console.info(this.list);
                    },
                    (response) => {
                        alert(response.status);
                    }
                ).catch(function (response) {
                    alert(response);
                });
            }
            // 获取当前时间函数
            //timeFormate(timeStamp) {
            //    let year = new Date(timeStamp).getFullYear();
            //    let month = new Date(timeStamp).getMonth() + 1 < 10 ? "0" + (new Date(timeStamp).getMonth() + 1) : new Date(timeStamp).getMonth() + 1;
            //    let date = new Date(timeStamp).getDate() < 10 ? "0" + new Date(timeStamp).getDate() : new Date(timeStamp).getDate();
            //    let hh = new Date(timeStamp).getHours() < 10 ? "0" + new Date(timeStamp).getHours() : new Date(timeStamp).getHours();
            //    let mm = new Date(timeStamp).getMinutes() < 10 ? "0" + new Date(timeStamp).getMinutes() : new Date(timeStamp).getMinutes();
            //     let ss =new Date(timeStamp).getSeconds() < 10? "0" + new Date(timeStamp).getSeconds(): new Date(timeStamp).getSeconds();
            //    //return year + "年" + month + "月" + date +"日"+" "+hh+":"+mm ;
            //    this.nowTime = year + "年" + month + "月" + date + "日" + " " + hh + ":" + mm + ":" + ss;
            //     //console.log(this.nowTime);
            //},
            //// 定时器函数
            //nowTimes() {
            //    this.timeFormate(new Date());
            //    setInterval(this.nowTimes, 1 * 1000);
            //}
        },
        //计算属性
        //computed: {
        //    indexs: function () {
        //        var left = 1;
        //        var right = this.all;
        //        var ar = [];
        //        if (this.all >= 5) {
        //            if (this.cur > 3 && this.cur < this.all - 2) {
        //                left = this.cur - 2
        //                right = this.cur + 2
        //            } else {
        //                if (this.cur <= 3) {
        //                    left = 1
        //                    right = 5
        //                } else {
        //                    right = this.all
        //                    left = this.all - 4
        //                }
        //            }
        //        }
        //        while (left <= right) {
        //            ar.push(left)
        //            left++
        //        }
        //        return ar
        //    }
        //},
    })

</script>
